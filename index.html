<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Brise Lomerta</title>
  <link href="https://fonts.googleapis.com/css2?family=Bungee&display=swap" rel="stylesheet" />
  <style>
    :root {
      --pink: #ff6ec7;
      --yellow: #ffd166;
      --blue: #49c6e5;
      --dark: #101010;
      --gray: #1c1c1c;
      --white: #fff;
    }
    html, body {
      background: var(--dark);
      color: var(--white);
      font-family: "Bungee", cursive;
      margin: 0; padding: 0; min-height: 100vh;
    }
    body { display: flex; flex-direction: column; min-height: 100vh; }
    h1 {
      text-align: center;
      font-size: 2.5rem;
      letter-spacing: 2px;
      background: linear-gradient(90deg,var(--pink),var(--yellow),var(--blue));
      -webkit-background-clip: text;
      color: transparent;
      margin: 32px 0 16px 0;
      text-shadow: 0 3px 24px #000a;
      animation: fadeinDown 1s cubic-bezier(.68,-0.2,.45,1.2);
    }
    #main {
      max-width: 480px;
      background: var(--gray);
      margin: 0 auto 32px;
      border-radius: 20px;
      box-shadow: 0 6px 32px #000a;
      padding: 30px 16px 28px;
      min-height: 300px;
      animation: fadeinUp 0.7s;
    }
    .fade-in { animation: fadeinUp 0.7s; }
    .result-anim { animation: fadeinPop 0.7s; }
    @keyframes fadeinDown { from {opacity:0;transform:translateY(-32px);} to {opacity:1;transform:translateY(0);} }
    @keyframes fadeinUp { from {opacity:0;transform:translateY(42px);} to {opacity:1;transform:translateY(0);} }
    @keyframes fadeinPop { from {opacity:0;transform:scale(0.7);} to {opacity:1;transform:scale(1);} }

    h2 {
      font-size: 1.4rem;
      margin-bottom: 20px;
      color: var(--yellow);
      letter-spacing: 1px;
    }
    input {
      font-size: 1rem;
      border-radius: 10px;
      border: none;
      outline: none;
      padding: 12px 16px;
      margin: 8px 0;
      width: 75%;
      box-shadow: 0 2px 8px #0004;
      transition: box-shadow 0.2s;
      background: #232323;
      color: var(--white);
      text-align: center;
    }
    input:focus { box-shadow: 0 0 0 3px var(--pink); }
    button {
      font-family: inherit;
      font-size: 1.08rem;
      border: none;
      border-radius: 13px;
      padding: 12px 26px;
      margin: 12px 4px 0 0;
      cursor: pointer;
      transition: background 0.15s, box-shadow 0.15s, color 0.18s, transform 0.16s;
      font-weight: 600;
      letter-spacing: 1px;
      box-shadow: 0 2px 16px #0003;
      opacity: 0;
      animation: buttonIn 0.5s forwards;
    }
    button:nth-of-type(1) { animation-delay: 0.07s;}
    button:nth-of-type(2) { animation-delay: 0.16s;}
    button:nth-of-type(3) { animation-delay: 0.24s;}
    button:nth-of-type(4) { animation-delay: 0.32s;}
    @keyframes buttonIn {
      from { opacity: 0; transform: translateY(20px);}
      to   { opacity: 1; transform: translateY(0);}
    }
    #addBtn { background: var(--pink); color: var(--dark);}
    #startBtn, #relBtn { background: var(--yellow); color: var(--dark);}
    #boisBtn { background: var(--blue); color: var(--dark);}
    #skipBtn { background: #ff6585; color: var(--white);}
    #homeBtn { background: #333; color: var(--pink); border: 2px solid var(--pink); margin-top: 12px; }
    #scores { margin: 18px 0 18px; text-align: center;}
    #scores span {
      background: linear-gradient(90deg,var(--pink) 40%, var(--blue));
      color: var(--dark);
      padding: 5px 14px;
      border-radius: 12px;
      margin: 3px 6px;
      font-size: 1rem;
      display: inline-block;
      box-shadow: 0 2px 7px #0003;
    }
    #card {
      background: linear-gradient(120deg, #232347 70%, #4ac0f7 100%);
      border-radius: 17px;
      padding: 28px 12px 18px;
      text-align: center;
      min-height: 100px;
      margin: 18px 0 22px;
      color: var(--white);
      font-size: 1.13rem;
      box-shadow: 0 4px 20px #2228;
      line-height: 1.5;
      word-break: break-word;
      letter-spacing: 0.5px;
      border: 2px solid var(--pink);
      position: relative;
      transition: transform 0.5s cubic-bezier(.68,-0.2,.45,1.2), opacity 0.5s cubic-bezier(.68,-0.2,.45,1.2);
      z-index: 2;
      overflow: hidden;
    }
    .slide-left { transform: translateX(-160vw) rotate(-15deg); opacity: 0; }
    .slide-right { transform: translateX(160vw) rotate(15deg); opacity: 0; }
    .slide-down { transform: translateY(80vh) scale(0.95); opacity: 0; }
    .badge {
      display: inline-block;
      padding: 6px 18px;
      font-size: 0.95em;
      border-radius: 12px 12px 12px 2px;
      background: linear-gradient(90deg, var(--pink), var(--yellow), var(--blue));
      color: #101010;
      font-weight: bold;
      letter-spacing: 0.5px;
      margin-bottom: 9px;
      margin-top: -14px;
      box-shadow: 0 3px 15px #0003;
    }
    .solo { border-left: 5px solid var(--yellow);}
    .all { border-left: 5px solid var(--blue);}
    #playerList span { background: var(--blue); color: var(--dark); border-radius: 8px; padding: 4px 12px; margin: 2px 5px; display: inline-block; font-size: .96rem; }
    #result { margin: 24px 0 20px; text-align: left; font-size: 1.1rem; }
    .midBtn { background: var(--blue); color: var(--dark); margin-top: 12px; }
    @media (max-width: 530px) { #main { padding: 14px 4vw 22px; } h1 { font-size: 2.08rem; } #card { font-size: 0.98rem; } }
    ::selection { background: var(--yellow); color: var(--dark); }
  </style>
</head>
<body>
  <h1>Brise Lomerta</h1>
  <div id="main"></div>
  <script>
    // Toutes les questions dans des objets avec cat√©gorie et mode¬†!
    const cards = [
      // D√©fi Alcool - SOLO
      {cat:"D√©fi Alcool", mode:"SOLO", text:"Bois 4 gorg√©es‚Ä¶ ou envoie un emoji üçÜ √† ton dernier crush."},
      {cat:"D√©fi Alcool", mode:"SOLO", text:'Appelle ton ex et dis-lui "je pense √† toi"‚Ä¶ ou bois cul sec.'},
      {cat:"D√©fi Alcool", mode:"SOLO", text:"Bois 1 gorg√©e pour chaque message non lu dans ton tel."},
      {cat:"D√©fi Alcool", mode:"SOLO", text:"Ouvre ton historique de recherche √† la personne de ton choix‚Ä¶ ou bois 3 gorg√©es."},
      {cat:"D√©fi Alcool", mode:"SOLO", text:"Bois 5 gorg√©es si tu n‚Äôas pas couch√© depuis plus d‚Äôun mois (sois honn√™te)."},
      {cat:"D√©fi Alcool", mode:"SOLO", text:"Montre la derni√®re photo re√ßue sur ton t√©l√©phone (hors perso) ou bois 2 gorg√©es."},
      {cat:"D√©fi Alcool", mode:"SOLO", text:'Bois 3 gorg√©es‚Ä¶ ou publie "j‚Äôai envie de tendresse ce soir ü•∫" en story.'},
      {cat:"D√©fi Alcool", mode:"SOLO", text:"Bois 2 gorg√©es si tu es d√©j√† sorti(e) avec 2 personnes en m√™me temps."},
      {cat:"D√©fi Alcool", mode:"SOLO", text:"Bois 1 gorg√©e pour chaque ex avec qui tu es toujours en contact."},
      {cat:"D√©fi Alcool", mode:"SOLO", text:"Fais un shot‚Ä¶ ou envoie un vocal sexy √† un(e) pote."},
      // D√©fi Alcool - Tous
      {cat:"D√©fi Alcool", mode:"TOUT LE MONDE JOUE", text:"Tout le monde boit si quelqu‚Äôun ici t‚Äôa d√©j√† attir√©(e)."},
      {cat:"D√©fi Alcool", mode:"TOUT LE MONDE JOUE", text:'Faites un "cheers" avec la personne qui vous attire le plus‚Ä¶ sinon, buvez tous 2 gorg√©es.'},
      {cat:"D√©fi Alcool", mode:"TOUT LE MONDE JOUE", text:'Tout le monde boit s‚Äôil/elle a d√©j√† supprim√© un message par honte.'},
      {cat:"D√©fi Alcool", mode:"TOUT LE MONDE JOUE", text:"Celui qui a le plus de stories dans les derni√®res 24h boit 3 gorg√©es."},
      {cat:"D√©fi Alcool", mode:"TOUT LE MONDE JOUE", text:"Le dernier √† avoir eu un rapport boit un shot (ou avoue la date)."},
      {cat:"D√©fi Alcool", mode:"TOUT LE MONDE JOUE", text:"Le premier qui regarde son t√©l√©phone boit 2 gorg√©es."},
      {cat:"D√©fi Alcool", mode:"TOUT LE MONDE JOUE", text:"Celui/celle qui a le plus de matchs sur Tinder boit."},
      {cat:"D√©fi Alcool", mode:"TOUT LE MONDE JOUE", text:"Tout le monde qui a d√©j√† stalk√© un ex r√©cemment boit."},
      {cat:"D√©fi Alcool", mode:"TOUT LE MONDE JOUE", text:'Faites un vote : celui/celle qui a l‚Äôair le plus "chaud ce soir" boit 3 gorg√©es.'},
      {cat:"D√©fi Alcool", mode:"TOUT LE MONDE JOUE", text:"Celui/celle qui a le plus de notifs non lues boit un shot."},
      // V√©rit√©s os√©es - SOLO
      {cat:"V√©rit√©s Os√©es", mode:"SOLO", text:"Dis le pr√©nom de la personne avec qui tu as pris le plus de plaisir... ou bois 3 gorg√©es."},
      {cat:"V√©rit√©s Os√©es", mode:"SOLO", text:"As-tu d√©j√† couch√© avec deux personnes en moins de 24h ? Dis oui/non‚Ä¶ ou bois."},
      {cat:"V√©rit√©s Os√©es", mode:"SOLO", text:"Quelle est ta pratique sexuelle pr√©f√©r√©e ? R√©ponds ou bois 2 gorg√©es."},
      {cat:"V√©rit√©s Os√©es", mode:"SOLO", text:"Dis si tu es plut√¥t dominant(e) ou soumis(e) au lit‚Ä¶ ou bois un shot."},
      {cat:"V√©rit√©s Os√©es", mode:"SOLO", text:"Donne le pr√©nom de ton/ta partenaire le/la moins performant(e)‚Ä¶ ou bois."},
      {cat:"V√©rit√©s Os√©es", mode:"SOLO", text:"As-tu d√©j√† menti pour coucher ? Dis ce que tu as dit, ou bois."},
      {cat:"V√©rit√©s Os√©es", mode:"SOLO", text:"Avoue ta pire honte pendant l‚Äôacte‚Ä¶ ou bois 3 gorg√©es."},
      {cat:"V√©rit√©s Os√©es", mode:"SOLO", text:"Dis la chose la plus sale qu‚Äôon t‚Äôait dite au lit‚Ä¶ ou bois."},
      {cat:"V√©rit√©s Os√©es", mode:"SOLO", text:"As-tu d√©j√† couch√© avec quelqu‚Äôun dont tu ne te souviens plus du pr√©nom ? Dis oui/non‚Ä¶ ou bois."},
      {cat:"V√©rit√©s Os√©es", mode:"SOLO", text:'Appelle un(e) pote et dis-lui "je te d√©sire" d‚Äôun ton s√©rieux‚Ä¶ ou bois cul sec.'},
      // V√©rit√©s os√©es - Tous
      {cat:"V√©rit√©s Os√©es", mode:"TOUT LE MONDE JOUE", text:"Tout le monde dit son nombre de partenaires ou boit 3 gorg√©es."},
      {cat:"V√©rit√©s Os√©es", mode:"TOUT LE MONDE JOUE", text:"Tout le monde doit dire ce qui l‚Äôexcite chez quelqu‚Äôun ici‚Ä¶ ou boire."},
      {cat:"V√©rit√©s Os√©es", mode:"TOUT LE MONDE JOUE", text:'Tout le monde doit voter : qui est le/la plus "chaud(e)" ici ?'},
      {cat:"V√©rit√©s Os√©es", mode:"TOUT LE MONDE JOUE", text:"Tout le monde dit s‚Äôil a d√©j√† couch√© sans capote‚Ä¶ ou boit."},
      {cat:"V√©rit√©s Os√©es", mode:"TOUT LE MONDE JOUE", text:"Celui ou celle qui a d√©j√† tromp√© boit 2 gorg√©es."},
      {cat:"V√©rit√©s Os√©es", mode:"TOUT LE MONDE JOUE", text:"Celui ou celle qui s‚Äôest d√©j√† film√©(e) dans un moment intime doit lever la main ou boire."},
      {cat:"V√©rit√©s Os√©es", mode:"TOUT LE MONDE JOUE", text:"Tout le monde dit ce qu‚Äôil/elle pr√©f√®re faire au lit‚Ä¶ ou boit."},
      {cat:"V√©rit√©s Os√©es", mode:"TOUT LE MONDE JOUE", text:"Celui qui avoue avoir couch√© dans le lieu le plus chelou est dispens√© de boire. Les autres : 2 gorg√©es."},
      {cat:"V√©rit√©s Os√©es", mode:"TOUT LE MONDE JOUE", text:"Tout le monde dit s‚Äôil/elle a d√©j√† √©t√© dans une relation toxique. Sinon : 2 gorg√©es."},
      {cat:"V√©rit√©s Os√©es", mode:"TOUT LE MONDE JOUE", text:"Tout le monde √©crit anonymement un fantasme. On les lit tous √† voix haute. Si tu refuses : 3 gorg√©es."},
      // Actions sexy - SOLO
      {cat:"Actions Sexy", mode:"SOLO", text:'Envoie √† un(e) pote un message ambigu : "Tu me manques ce soir‚Ä¶" ou bois.'},
      {cat:"Actions Sexy", mode:"SOLO", text:"Prends un selfie sexy ici, maintenant‚Ä¶ ou bois 3 gorg√©es."},
      {cat:"Actions Sexy", mode:"SOLO", text:"Fais un bisou dans le cou √† la personne de ton choix‚Ä¶ ou bois."},
      {cat:"Actions Sexy", mode:"SOLO", text:'Chuchote "Je te veux" √† quelqu‚Äôun ici, regard intense obligatoire‚Ä¶ ou bois.'},
      {cat:"Actions Sexy", mode:"SOLO", text:"Propose √† quelqu‚Äôun de faire un mini slow avec toi‚Ä¶ ou bois."},
      {cat:"Actions Sexy", mode:"SOLO", text:'Regarde la personne √† ta droite dans les yeux et dis : "Tu sais ce que je veux‚Ä¶" ou bois.'},
      {cat:"Actions Sexy", mode:"SOLO", text:'Prends la main de quelqu‚Äôun et dis : "On en reparlera apr√®s la partie‚Ä¶" ou bois.'},
      {cat:"Actions Sexy", mode:"SOLO", text:"Imite ta fa√ßon de s√©duire en 10 secondes‚Ä¶ ou bois 2 gorg√©es."},
      {cat:"Actions Sexy", mode:"SOLO", text:"Envoie un c≈ìur √† un ex‚Ä¶ ou bois un shot."},
      {cat:"Actions Sexy", mode:"SOLO", text:"D√©cris ta tenue id√©ale pour une nuit torride‚Ä¶ ou bois."},
      // Actions sexy - Tous
      {cat:"Actions Sexy", mode:"TOUT LE MONDE JOUE", text:"Tout le monde fait un clin d‚Äô≈ìil √† la personne de son choix‚Ä¶ ou boit 1 gorg√©e."},
      {cat:"Actions Sexy", mode:"TOUT LE MONDE JOUE", text:"Tout le monde mime un moment sexy (restons soft) ou boit 2 gorg√©es."},
      {cat:"Actions Sexy", mode:"TOUT LE MONDE JOUE", text:"Celui ou celle qui fait la meilleure imitation d‚Äôun baiser re√ßoit l‚Äôimmunit√©, les autres boivent."},
      {cat:"Actions Sexy", mode:"TOUT LE MONDE JOUE", text:"Tour de compliments sexy : chacun doit en faire un √† quelqu‚Äôun ou boire."},
      {cat:"Actions Sexy", mode:"TOUT LE MONDE JOUE", text:"Tout le monde fait une danse lente, yeux ferm√©s, comme s‚Äôil y avait slow."},
      {cat:"Actions Sexy", mode:"TOUT LE MONDE JOUE", text:"Tout le monde envoie un emoji sexy dans un groupe au hasard‚Ä¶ ou boit."},
      {cat:"Actions Sexy", mode:"TOUT LE MONDE JOUE", text:"Chacun chuchote un mot chaud √† l‚Äôoreille d‚Äôun joueur diff√©rent. Pas de mot ? 2 gorg√©es."},
      {cat:"Actions Sexy", mode:"TOUT LE MONDE JOUE", text:"Tout le monde vote : qui a le regard le plus intense ? Le ou la gagnant(e) choisit qui boit."},
      {cat:"Actions Sexy", mode:"TOUT LE MONDE JOUE", text:"Tout le monde √©crit un message sexy fictif, les messages sont tir√©s au sort et lus √† voix haute."},
      {cat:"Actions Sexy", mode:"TOUT LE MONDE JOUE", text:"Tout le monde doit poser sa main sur quelqu‚Äôun d‚Äôautre pendant 5 secondes‚Ä¶ ou boire."},
      // Mini-jeux - SOLO
      {cat:"Mini-jeux", mode:"SOLO", text:'Fais une impro de 30 secondes "Comment draguer dans une √©glise".'},
      {cat:"Mini-jeux", mode:"SOLO", text:"Chante une chanson sexy‚Ä¶ comme si tu faisais une d√©claration d‚Äôamour √† ton frigo."},
      {cat:"Mini-jeux", mode:"SOLO", text:"Fais une pub torride pour une brosse √† dents."},
      {cat:"Mini-jeux", mode:"SOLO", text:"Mime une position improbable du kamasutra (sans trop exag√©rer) ou bois."},
      {cat:"Mini-jeux", mode:"SOLO", text:"Fais semblant de faire l‚Äôamour √† une chaise‚Ä¶ ou bois 3 gorg√©es."},
      {cat:"Mini-jeux", mode:"SOLO", text:'Cr√©e une chor√©graphie de 10 sec fa√ßon "Je suis pr√™t(e) pour ce soir".'},
      {cat:"Mini-jeux", mode:"SOLO", text:"Raconte un fantasme fa√ßon conte pour enfants‚Ä¶ ou bois."},
      {cat:"Mini-jeux", mode:"SOLO", text:'Fais une impro "Speed date avec quelqu‚Äôun d‚Äôhorrible"‚Ä¶ ou bois.'},
      {cat:"Mini-jeux", mode:"SOLO", text:"Mime une rupture ultra dramatique comme dans une telenovela."},
      {cat:"Mini-jeux", mode:"SOLO", text:"Fais une vid√©o TikTok sexy improvis√©e (sans la poster)‚Ä¶ ou bois un shot."},
      // Mini-jeux - Tous
      {cat:"Mini-jeux", mode:"TOUT LE MONDE JOUE", text:"Tout le monde mime une sc√®ne d‚Äôamour sans se toucher. Rires = 1 gorg√©e."},
      {cat:"Mini-jeux", mode:"TOUT LE MONDE JOUE", text:"Tout le monde √©crit un mot hot, les mots sont mim√©s anonymement."},
      {cat:"Mini-jeux", mode:"TOUT LE MONDE JOUE", text:"Tout le monde chante une chanson d‚Äôamour fa√ßon ASMR."},
      {cat:"Mini-jeux", mode:"TOUT LE MONDE JOUE", text:'Faites une impro √† deux : "Premi√®re nuit ensemble apr√®s 5 ans d‚Äôattente".'},
      {cat:"Mini-jeux", mode:"TOUT LE MONDE JOUE", text:"Tout le monde mime un orgasme silencieux‚Ä¶ le plus cr√©dible d√©signe qui boit."},
      {cat:"Mini-jeux", mode:"TOUT LE MONDE JOUE", text:"Chacun choisit un emoji sexy et l‚Äôinterpr√®te physiquement."},
      {cat:"Mini-jeux", mode:"TOUT LE MONDE JOUE", text:"Tout le monde imite un(e) prof qui tente de s√©duire un(e) √©l√®ve adulte."},
      {cat:"Mini-jeux", mode:"TOUT LE MONDE JOUE", text:"Concours de soupirs sexy : le plus g√™nant gagne, les autres boivent."},
      {cat:"Mini-jeux", mode:"TOUT LE MONDE JOUE", text:"Tout le monde fait une d√©claration d‚Äôamour absurde √† un objet de la pi√®ce."},
      {cat:"Mini-jeux", mode:"TOUT LE MONDE JOUE", text:'Tout le monde mime "se faire surprendre au lit" ‚Äì le plus dr√¥le est safe, les autres boivent.'},
    ];

    const main = document.getElementById('main');
    let players = [], scores = {}, deck = [], curPlayer = 0, curCard = 0, tourJoue = 0;

    function showPlayerForm() {
      main.innerHTML = `
        <h2>Ajoute les joueurs</h2>
        <input id="playerInput" placeholder="Nom du joueur" autofocus>
        <button id="addBtn">Ajouter</button>
        <div id="playerList"></div>
        <button id="startBtn">Commencer</button>
      `;
      main.classList.add('fade-in');
      document.getElementById('addBtn').onclick = () => {
        const name = document.getElementById('playerInput').value.trim();
        if (name && !players.includes(name)) {
          players.push(name);
          scores[name] = 0;
          updatePlayerList();
        }
        document.getElementById('playerInput').value = "";
        document.getElementById('playerInput').focus();
      };
      document.getElementById('startBtn').onclick = () => {
        if (players.length < 2) { alert('Ajoute au moins 2 joueurs !'); return; }
        startGame();
      };
      function updatePlayerList() {
        document.getElementById('playerList').innerHTML = players.map(p => `<span>${p}</span>`).join(' ');
      }
    }

    function startGame() {
      const n = Math.floor(cards.length / players.length);
      deck = [];
      let pool = [...cards];
      for (let p of players) {
        let pCards = [];
        for (let i = 0; i < n; i++) {
          let idx = Math.floor(Math.random() * pool.length);
          pCards.push({ ...pool[idx], owner: p });
          pool.splice(idx, 1);
        }
        deck = deck.concat(pCards);
      }
      shuffle(deck);
      curPlayer = 0; curCard = 0; tourJoue = 0;
      showCard();
    }

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        let j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }

    function showCard() {
      if (curCard >= deck.length) { showResult(); return; }
      const card = deck[curCard];
      main.innerHTML = `
        <div id="scores">${players.map(p => `<span>${p}: ${scores[p]}</span>`).join(' ')}</div>
        <div><b>√Ä ${players[curPlayer]} de jouer</b></div>
        <div id="card" class="${card.mode==='SOLO'?'solo':'all'}">
          <div class="badge">${card.cat} <span style="font-size:.93em">${card.mode}</span></div>
          <div style="margin-top:12px;">${card.text}</div>
        </div>
        <button id="relBtn">Je rel√®ve le d√©fi (+2)</button>
        <button id="boisBtn">Je bois (+1)</button>
        <button id="skipBtn">Je ne joue pas (-1)</button>
        <button id="homeBtn" class="home-btn">Accueil</button>
      `;
      main.classList.remove('result-anim');
      main.classList.add('fade-in');
      const relBtn = document.getElementById('relBtn');
      const boisBtn = document.getElementById('boisBtn');
      const skipBtn = document.getElementById('skipBtn');
      relBtn.onclick = () => animateCard('slide-left', ()=>{ scores[card.owner] += 2; next(); });
      boisBtn.onclick = () => animateCard('slide-right', ()=>{ scores[card.owner] += 1; next(); });
      skipBtn.onclick = () => animateCard('slide-down', ()=>{ scores[card.owner] -= 1; next(); });
      document.getElementById('homeBtn').onclick = () => resetToHome();
    }

    function animateCard(anim, cb) {
      const cardEl = document.getElementById('card');
      cardEl.classList.add(anim);
      setTimeout(cb, 450);
    }

    function next() {
      curCard++;
      curPlayer = (curPlayer + 1) % players.length;
      tourJoue++;
      if (tourJoue % players.length === 0 && curCard < deck.length) {
        showMidScreen();
      } else {
        showCard();
      }
    }

    function showMidScreen() {
      main.innerHTML = `
        <h2>Fin du tour</h2>
        <div id="scores">${players.map(p => `<span>${p}: ${scores[p]}</span>`).join(' ')}</div>
        <button id="continueBtn" class="midBtn">Continuer la partie</button>
        <button id="finishBtn" class="midBtn">Afficher le classement</button>
      `;
      main.classList.add('fade-in');
      document.getElementById('continueBtn').onclick = () => showCard();
      document.getElementById('finishBtn').onclick = () => showResult();
    }

    function showResult() {
      let sorted = players.slice().sort((a,b)=>scores[b]-scores[a]);
      main.innerHTML = `<h2>Classement final</h2>
        <div id="result" class="result-anim">${sorted.map((p,i)=>`${i+1}. ${p}: ${scores[p]} pts`).join('<br>')}</div>
        <button onclick="location.reload()" id="replayBtn">Rejouer</button>
        <button id="homeBtn" class="home-btn">Accueil</button>
      `;
      main.classList.remove('fade-in');
      main.classList.add('result-anim');
      document.getElementById('homeBtn').onclick = () => resetToHome();
    }

    function resetToHome() {
      players = [];
      scores = {};
      deck = [];
      curPlayer = 0;
      curCard = 0;
      tourJoue = 0;
      showPlayerForm();
    }

    showPlayerForm();
  </script>
</body>
</html>
